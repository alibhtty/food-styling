var $body=$("body"),site=$body.attr("data-site"),height=$(window).height(),width=$(window).width(),$mobileMenuButton=$("#menuButton"),$mobileMenuWrapper=$("#mobileMenuWrapper"),isActive=!1;function openMenuAnimations(){$body.addClass("stopScrolling"),$mobileMenuButton.addClass("active"),TweenMax.to($mobileMenuWrapper,.3,{autoAlpha:1})}function closeMenuAnimations(){$mobileMenuButton.removeClass("active"),$body.removeClass("stopScrolling"),TweenMax.to($mobileMenuWrapper,.3,{autoAlpha:0})}$mobileMenuButton.on("click",(function(e){e.preventDefault(),$mobileMenuButton.addClass("working"),(isActive=!isActive)?openMenuAnimations():closeMenuAnimations(),setTimeout((function(){$mobileMenuButton.removeClass("working")}),200)})),Modernizr.objectfit||$(".objectFitWrapper").each((function(){var e=$(this),t=e.find("img").prop("src");t&&e.css("backgroundImage","url("+t+")").addClass("objectFitFallBack")})),function(e){e.fn.rhBanner=function(t){var o,a,r=e.extend({parallaxRatio:1.4,ajax:!1,selector:"body"},t),n=function(){for(var e,t="transform webkitTransform mozTransform oTransform msTransform".split(" "),o=0;void 0===e;)e=null!=document.createElement("div").style[t[o]]?t[o]:void 0,o++;return e}(),i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},l=this,s=l.length,c=[];function d(){o=-1,a=window.innerHeight;var e=0;for(e=0;e<s;e++){c[e]=c[e]||{el:l[e]};var t=c[e].el.getBoundingClientRect();c[e].height=c[e].el.offsetHeight,!1===r.ajax?c[e].start=t.top+window.pageYOffset:c[e].start=t.top,c[e].stop=c[e].start+c[e].height,c[e].child=c[e].el.childNodes[1],c[e].child.style.height=c[e].height*r.parallaxRatio+"px",c[e].childHeight=c[e].child.offsetHeight,c[e].offset=c[e].childHeight-c[e].height}}function p(e,t){n?e.child.style[n]="translate3d(0, "+t+"px,0)":e.child.style.top=t}e(window).resize((function(){d()})),d(),function t(){var n;n=!1===r.ajax?window.pageYOffset:e(r.selector).scrollTop();if(o==n)return i(t),!1;o=!1===r.ajax?window.pageYOffset:e(r.selector).scrollTop();var l=0;for(l=0;l<s;l++)if(o>=c[l].start-a&&o<=c[l].stop){var d=c[l].start-a,m=c[l].stop,u=(o-d)/(m-d),y=c[l].offset*u,f=-c[l].offset+y;p(c[l],f)}i(t)}()}}(jQuery),function(e){e.fn.rhLazy=function(t){var o=e.extend({scrollThreshold:100,ajax:!1},t);var a,r=document.querySelectorAll("img.lazy");function n(){r=document.querySelectorAll("img.lazy"),a&&clearTimeout(a),a=setTimeout((function(){if(!1===o.ajax)var e=window.pageYOffset;else{var t=document.getElementById("ajaxOverlay");e=t.scrollTop}r.forEach((function(t){(function(e){var t=e.getBoundingClientRect();if(!1===o.ajax)var a=window.pageYOffset||document.documentElement.scrollTop;else a=document.getElementById("ajaxOverlay").scrollTop;return{top:t.top+a}})(t).top<window.innerHeight+e+o.scrollThreshold&&(t.src=t.dataset.src,t.classList.remove("lazy"))})),0==r.length&&(document.removeEventListener("scroll",n),window.removeEventListener("resize",n),window.removeEventListener("orientationChange",n))}),20)}n(),!1===o.ajax?document.addEventListener("scroll",n):document.getElementById("ajaxOverlay").addEventListener("scroll",n),window.addEventListener("resize",n),window.addEventListener("orientationChange",n)}}(jQuery),function(e){e.fn.rhLoadIn=function(t){var o=e.extend({scrollThreshold:50,ajax:!1},t);var a,r=document.querySelectorAll(".loadIn");function n(){r=document.querySelectorAll(".loadIn"),a&&clearTimeout(a),a=setTimeout((function(){if(!1===o.ajax)var e=window.pageYOffset;else{var t=document.getElementById("ajaxOverlay");e=t.scrollTop}r.forEach((function(t){(function(e){var t=e.getBoundingClientRect();if(!1===o.ajax)var a=window.pageYOffset||document.documentElement.scrollTop;else a=document.getElementById("ajaxOverlay").scrollTop;return{top:t.top+a}})(t).top<window.innerHeight+e+o.scrollThreshold&&(t.classList.add("isVisible"),setTimeout((function(){t.classList.remove("loadIn")}),600))})),0==r.length&&(document.removeEventListener("scroll",n),window.removeEventListener("resize",n),window.removeEventListener("orientationChange",n))}),20)}n(),!1===o.ajax?document.addEventListener("scroll",n):document.getElementById("ajaxOverlay").addEventListener("scroll",n),window.addEventListener("resize",n),window.addEventListener("orientationChange",n)}}(jQuery);var videosrc,$playVideo=$(".playVideo"),$videoOverlay=$("#videoOverlay"),$closeVideoOverlay=$("#closeVideoOverlay");$playVideo.length&&($playVideo.on("click",(function(e){e.preventDefault(),videosrc=$(this).data("src"),$("#videoOverlay iframe").attr("src",videosrc),$videoOverlay.fadeIn()})),$closeVideoOverlay.on("click",(function(e){e.preventDefault(),$videoOverlay.fadeOut(),$("#videoOverlay iframe").attr("src","")})));var i,videoElems=document.getElementsByClassName("inlineVideo");function inlineVideo(){for(i=0;i<videoElems.length;i++){videoElems[i].addEventListener("canplay",videoReady),videoElems[i].readyState>3&&videoElems[i].classList.add("ready")}}function videoReady(){this.classList.add("ready")}videoElems.length>0&&inlineVideo(),document.addEventListener("DOMContentLoaded",(function(){var e=[].slice.call(document.querySelectorAll("video.lazyVideo"));if("IntersectionObserver"in window){var t=new IntersectionObserver((function(e){e.forEach((function(e){if(e.isIntersecting){for(var o in e.target.children){var a=e.target.children[o];"string"==typeof a.tagName&&"SOURCE"===a.tagName&&(a.src=a.dataset.src)}e.target.load(),e.target.classList.remove("lazyVideo"),t.unobserve(e.target)}}))}),{rootMargin:"0px 0px 500px 0px"});e.forEach((function(e){t.observe(e)}))}})),$(".releasesCarousel").each((function(e,t){var o=$(t),a=o.find(".nextReleaseButton"),r=o.flickity({wrapAround:!0,autoPlay:!1,pageDots:!1,prevNextButtons:!1,cellSelector:".releaseSlide",cellAlign:"left",lazyLoad:!0,groupCells:1,setGallerySize:!0,imagesLoaded:!0});a.on("click",(function(e){e.preventDefault(),r.flickity("next",!0)}))}));var $openMixerButton=$("#openMixerButton"),$mixerOverlay=$("#mixerOverlay"),$closeMixerButton=$("#closeMixerButton"),$mixerEmbed=$("#mixerEmbed"),$mixerChat=$("#mixerChat");$openMixerButton.on("click",(function(e){e.preventDefault(),$body.addClass("stopScrolling"),$mixerEmbed.attr("src",$mixerEmbed.data("src")),$mixerChat.attr("src",$mixerChat.data("src")),new TimelineMax({}).to($mixerOverlay,1,{autoAlpha:1}).to($closeMixerButton,.6,{autoAlpha:1},"-=0").to($mixerEmbed,.6,{autoAlpha:1},"-=0.2").to($mixerChat,.6,{autoAlpha:1},"-=0.6")})),$closeMixerButton.on("click",(function(e){e.preventDefault(),$body.removeClass("stopScrolling"),new TimelineMax({}).to($mixerOverlay,1,{autoAlpha:0}).to($closeMixerButton,.6,{autoAlpha:0},"-=0").to($mixerEmbed,.6,{autoAlpha:0},"-=0.2").to($mixerChat,.6,{autoAlpha:0},"-=0.6"),setTimeout((function(){$mixerEmbed.attr("src",""),$mixerChat.attr("src","")}),600)}));var $loadMoreNews=$("#loadMoreNews");function loadNews(){var e,t,o,a,r,n=$("#loadingNews"),i=$("#noMoreNews"),l=$("#loadingBay");$body.addClass("working"),t=$loadMoreNews.attr("href"),e=$loadMoreNews.data("total"),o=$loadMoreNews.data("next"),n.show(),o<=e&&l.load(t+" #ajaxHolder",(function(){r=l.find(".newsCard"),$("#ajaxHolder").append(r),o++,$loadMoreNews.data("next",o),o>e&&($loadMoreNews.hide(),i.show(),n.hide()),a=site+"/news/page/"+o,$loadMoreNews.attr("href",a),location.href!=t&&history.pushState({},"",t),$body.rhLoadIn(),$body.rhLazy({scrollThreshold:100}),l.empty(),$body.removeClass("working"),n.hide()}))}$loadMoreNews.on("click",(function(e){e.preventDefault(),loadNews()}));var storage,isInArray,likeArray,num,postID,stor=!0;function checkLikes(){!0===stor&&(storage=localStorage.getItem("likeArray"),$(".likeHeart").each((function(){var e=$(this).data("id");-1!==storage.indexOf(e)&&$(this).addClass("active")})))}function isLocalStorageNameSupported(){var e=window.sessionStorage;try{return e.setItem("test","1"),e.removeItem("test"),!0}catch(e){return!1}}0==isLocalStorageNameSupported()&&(stor=!1),!0===stor?(null===localStorage.getItem("likeArray")?(likeArray=[],localStorage.setItem("likeArray",likeArray)):likeArray=[likeArray=localStorage.getItem("likeArray")],$(document).on("click",".likeHeart",(function(e){e.preventDefault();var t=$(this);t.addClass("working"),num=(num=t.find("span").text()).replace(",",""),postID=t.attr("data-id"),storage=localStorage.getItem("likeArray"),-1!==(isInArray=storage.indexOf(postID))||$.ajax({url:site+"/wp/wp-content/themes/deadmau5/phpScripts/like-system.php?post_id="+postID}).done((function(e){0!==e&&($("body").find(".likeHeart"+postID).addClass("active").find("span").text(e),likeArray.push(postID),localStorage.setItem("likeArray",likeArray),storage=localStorage.getItem("likeArray"))})).fail((function(){}))}))):$(document).on("click",".likeButton",(function(e){e.preventDefault()})),checkLikes();var winWidth=520,winHeight=350,winTop=screen.height/2-winHeight/2,winLeft=screen.width/2-winWidth/2,popupMeta="top="+winTop+",left="+winLeft+",toolbar=0,status=0,width="+winWidth+",height="+winHeight;function socialShare(e,t,o){"facebook"==e?window.open("http://www.facebook.com/sharer/sharer.php?u="+t,"sharer",popupMeta):"twitter"==e?window.open("https://twitter.com/intent/tweet?text="+o+"%20-%20&url="+t,"sharer",popupMeta):"reddit"==e&&window.open("http://www.reddit.com/submit?url="+t+"&title="+t,"sharer",popupMeta)}var $map=$("#map");if($map.length>0){var map,showLatLng,initialZoom,mapOptions,mapElement,$mapWrapper=$("#mapWrapper"),$mapCountry=$("#mapCountry"),$mapStation=$("#mapStation"),$mapDay=$("#mapDay"),$mapTime=$("#mapTime"),$mapLink=$("#mapLink"),$mapOverlay=$("#mapOverlay"),overlays=[],$mapViewButton=$("#mapViewButton"),$listViewButton=$("#listViewButton"),$listWrapper=$("#listWrapper"),$closeRadioOverlay=$("#closeRadioOverlay");$mapViewButton.on("click",(function(e){e.preventDefault(),$(window).scrollTop(0),$mapViewButton.addClass("active"),$listViewButton.removeClass("active"),$mapWrapper.show(),$listWrapper.hide(),$listWrapper.find(".listInner").removeClass("isVisible")})),$listViewButton.on("click",(function(e){e.preventDefault(),$(window).scrollTop(0),$listViewButton.addClass("active"),$mapViewButton.removeClass("active"),$mapOverlay.removeClass("active"),$mapWrapper.hide(),$listWrapper.show(),$listWrapper.find(".listInner").addClass("loadIn"),$body.rhLoadIn()})),$closeRadioOverlay.on("click",(function(e){e.preventDefault(),$mapOverlay.removeClass("active")})),google.maps.event.addDomListener(window,"load",initialize),CustomMarker.prototype=new google.maps.OverlayView,CustomMarker.prototype.draw=function(){var e=this,t=this.div;if(!t){(t=this.div=document.createElement("div")).className="mapMarker";var o=document.createElement("span");o.className="transition",t.appendChild(o);var a=document.createTextNode(e.args.marker_station);t.appendChild(a);var r=this.latlng;google.maps.event.addDomListener(t,"click",(function(){google.maps.event.trigger(e,"click"),$mapOverlay.addClass("active").css({background:"#121212"}),setTimeout((function(){$mapOverlay.css({background:"#000000"})}),300),map.panTo(r),map.getZoom()<4&&map.setZoom(4),$mapCountry.text(e.args.marker_country),$mapStation.text(e.args.marker_station),$mapDay.text(e.args.marker_day),$mapTime.text(e.args.marker_time),$mapLink.attr("href",e.args.marker_link)})),this.getPanes().overlayImage.appendChild(t)}var n=this.getProjection().fromLatLngToDivPixel(this.latlng);n&&(t.style.left=n.x-10+"px",t.style.top=n.y-10+"px")}}function initialize(){showLatLng=new google.maps.LatLng(25,0),mapOptions={zoom:initialZoom=3,minZoom:1,center:showLatLng,disableDefaultUI:!0,backgroundColor:"#232323",styles:[{featureType:"all",elementType:"labels.text.fill",stylers:[{saturation:36},{color:"#000000"},{lightness:20}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{visibility:"off"},{color:"#000000"},{lightness:16}]},{featureType:"all",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#000000"}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#000000"},{weight:1.2}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#151416"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#1a1a1a"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#000000"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#000000"},{weight:.2}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#000000"}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#000000"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#000000"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#232323"}]}]},mapElement=document.getElementById("map"),map=new google.maps.Map(mapElement,mapOptions),processData()}function processData(){$.getJSON(site+"/wp/wp-content/themes/deadmau5/phpScripts/markers.php","",(function(e){$.each(e,(function(e,t){var o=t.country,a=t.station,r=t.day,n=t.time,i=t.link,l=t.location.lat,s=t.location.lng;if(l&&s){var c=new google.maps.LatLng(l,s);overlays.push(new CustomMarker(c,map,{marker_country:o,marker_station:a,marker_day:r,marker_time:n,marker_link:i}))}}))})).done((function(){})).fail((function(){})).always((function(){}))}function CustomMarker(e,t,o){this.latlng=e,this.args=o,this.setMap(t)}var $mapButtonWrapper=$("#mapButtonWrapper");if($mapButtonWrapper.length>0){var $footerWrapper=$("#footerWrapper");$(window).on("scroll",radioScroll)}function radioScroll(){var e=$(window).scrollTop(),t=$footerWrapper.offset().top;e+height<t?$mapButtonWrapper.addClass("sticky"):$mapButtonWrapper.removeClass("sticky")}$(document).ready((function(){$body.removeClass("preload"),$body.rhLoadIn(),$body.rhLazy({scrollThreshold:100}),$(".parallax").rhBanner({parallaxRatio:1.4})}));var $scrollButton=$("#scrollButton");function mau5Scroll(){st=$(window).scrollTop();var e=st/2;$("#homepageHero").css({top:e+"px"})}$scrollButton.length>0&&$scrollButton.on("click",(function(e){e.preventDefault(),$(window).scrollTo(height-48,600,{axis:"y"})})),$(window).on("scroll",mau5Scroll);var $testPilotOverlay=$("#testPilotOverlay"),$engageButton=$("#engageButton"),$closeTestPilot=$("#closeTestPilot");$engageButton.on("click",(function(e){e.preventDefault();var t=Math.floor(4*Math.random())+1;$body.removeClass("crazy1 crazy2 crazy3 crazy4 crazy5"),$body.addClass("crazy"+t),TweenMax.to($testPilotOverlay,.5,{autoAlpha:1,delay:.3})})),$closeTestPilot.on("click",(function(e){e.preventDefault(),$body.removeClass("crazy1 crazy2 crazy3 crazy4 crazy5"),TweenMax.to($testPilotOverlay,.4,{autoAlpha:0})})),$(window).resize((function(){$(window).width(),width=$(window).width()}));